# Example values enabling the Cerebros runner, MLflow tracking server, and Livebook workspace.
# Combine with the default chart values or override selectively via --set/--values.

image:
  repository: thunderline/app
  tag: "2.1.0"

env:
  MINIO_BUCKET: "thunderline-artifacts"
  SERVICE_NAME: "thunderline"
  LOG_LEVEL: "info"
  CEREBROS_MODE: "remote"
  FEATURES: "ml_nas,cerebros_bridge"

  secrets:
    DATABASE_URL: "ecto://postgres:postgres@postgres:5432/thunderline"
    MINIO_ENDPOINT: "http://minio:9000"
    MINIO_ACCESS_KEY: "minio"
    MINIO_SECRET_KEY: "minio123"
    AWS_ACCESS_KEY_ID: "minio"
    AWS_SECRET_ACCESS_KEY: "minio123"
    MLFLOW_S3_ENDPOINT_URL: "http://minio:9000"

web:
  env:
    START_ENDPOINT: "true"
    START_OBAN: "true"
    START_COMPUTE: "false"

worker:
  env:
    START_ENDPOINT: "false"
    START_OBAN: "true"
    START_COMPUTE: "false"

postgresql:
  enabled: true
  auth:
    username: postgres
    password: postgres
    database: thunderline

minio:
  enabled: true
  auth:
    rootUser: minio
    rootPassword: minio123
  defaultBuckets: "thunderline-artifacts"

mlflow:
  enabled: true
  backendStoreUri: "sqlite:////data/mlflow.db"
  artifactRoot: "s3://thunderline-artifacts/mlflow"
  env:
    AWS_ACCESS_KEY_ID: "minio"
    AWS_SECRET_ACCESS_KEY: "minio123"
    MLFLOW_S3_ENDPOINT_URL: "http://minio:9000"

cerebrosRunner:
  enabled: true
  env:
    MLFLOW_EXPERIMENT_NAME: "thunderline-livebook"

livebook:
  enabled: true
  secrets:
    password: "supersecret"
  env:
    LIVEBOOK_TOKEN_ENABLED: "false"
    LIVEBOOK_DEFAULT_RUNTIME: "attached:thunderline"
  ingress:
    enabled: false # combine with values-livebook-tls.yaml to expose Livebook securely
