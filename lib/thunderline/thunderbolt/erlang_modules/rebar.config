%% THUNDERCELL Erlang Dependencies Configuration
%% 
%% Rebar3 configuration for THUNDERCELL Erlang compute layer

{erl_opts, [debug_info,
           {parse_transform, lager_transform},
           warnings_as_errors,
           warn_export_all,
           warn_unused_import]}.

{deps, [
    %% GraphQL for Erlang - Advanced GraphQL endpoint capabilities
    {graphql, {git, "https://github.com/jlouis/graphql-erlang.git", {branch, "master"}}},
    
    %% Lager - High-performance logging framework
    {lager, "3.9.2"},
    
    %% Testing frameworks
    {meck, "0.9.2"},
    {proper, "1.4.0"},
    
    %% Additional performance and utility libraries
    {recon, "2.5.5"},        % Production debugging and introspection
    {poolboy, "1.5.2"},      % Worker pool management
    {gproc, "0.9.1"},        % Extended process registry
    {jiffy, "1.1.2"}         % High-performance JSON encoding/decoding
]}.

{profiles, [
    {test, [
        {deps, [
            {ct_helper, "1.1.0"},
            {eunit_formatters, "0.5.0"}
        ]},
        {erl_opts, [debug_info, export_all]}
    ]},
    {prod, [
        {erl_opts, [no_debug_info, compressed]}
    ]}
]}.

{plugins, [
    {rebar3_proper, "0.12.1"},
    {rebar3_lint, "3.2.6"}
]}.

{shell, [
    {config, "config/sys.config"},
    {apps, [thundercell]}
]}.

{relx, [{release, {thundercell, "1.0.0"},
         [thundercell,
          kernel,
          stdlib,
          crypto,
          mnesia,
          lager,
          gproc,
          graphql]},

        {sys_config, "./config/sys.config"},
        {vm_args, "./config/vm.args"},

        {dev_mode, true},
        {include_erts, false},

        {extended_start_script, true}]}.

{cover_enabled, true}.
{cover_opts, [verbose]}.

{dialyzer, [
    {warnings, [
        no_return,
        no_unused,
        no_improper_lists,
        no_fun_app,
        no_match,
        no_opaque,
        no_fail_call,
        error_handling,
        race_conditions,
        unmatched_returns
    ]},
    {get_warnings, true},
    {plt_apps, top_level_deps},
    {plt_extra_apps, [kernel, stdlib, erts, crypto, mnesia, lager]}
]}.

{xref_checks, [
    undefined_function_calls,
    undefined_functions,
    locals_not_used,
    exports_not_used,
    deprecated_function_calls,
    deprecated_functions
]}.

%% Documentation
{edoc_opts, [
    {doclet, edown_doclet},
    {src_path, ["src"]},
    {subpackages, true}
]}.

%% Performance and profiling
{eunit_opts, [verbose, {report,{eunit_surefire,[{dir,"."}]}}]}.
{ct_opts, [{sys_config, ["config/test.config"]}]}.
